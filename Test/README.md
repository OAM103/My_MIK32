# PLC Hardware Test Stand (MIK32)

<img width="960" height="1280" alt="image" src="https://github.com/user-attachments/assets/05555ee6-80ca-40e9-bd32-f1beca6811fe" />

–ü—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–π —á–∞—Å—Ç–∏ –ü–õ–ö –Ω–∞ –±–∞–∑–µ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ MIK32.
–†–µ–∞–ª–∏–∑—É–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –≤—Ö–æ–¥–æ–≤, —Ä–µ–ª–µ, –∞–Ω–∞–ª–æ–≥–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –∏ –ø–∏—Ç–∞–Ω–∏—è, —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–æ –≤–Ω–µ—à–Ω—é—é SPI Flash –ø–∞–º—è—Ç—å –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –≤—ã–≤–æ–¥–æ–º –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ UART.
## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è:
*–≤—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –ü–õ–ö;
*–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏—Å–ø—ã—Ç–∞–Ω–∏–π;
*–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –æ—Ç–∫–∞–∑–æ–≤;
*–Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ç–µ—Å—Ç–æ–≤ –≤–æ Flash-–ø–∞–º—è—Ç–∏;
*–∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±–µ–∑ –ü–ö (–∫–Ω–æ–ø–∫–∞ + —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã).

## –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞

–ú–ö: MIK32 (mik32v2)
Flash: –≤–Ω–µ—à–Ω—è—è SPI Flash W25 (—á–µ—Ä–µ–∑ SPIFI)
---
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:
GPIO (–≤—Ö–æ–¥—ã/–≤—ã—Ö–æ–¥—ã)
ADC (3 –∫–∞–Ω–∞–ª–∞)
UART (–≤—ã–≤–æ–¥ –ª–æ–≥–æ–≤)
–ü–∏—Ç–∞–Ω–∏–µ: 12 –í (–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ ADC)
##üì∑ –§–æ—Ç–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ü–õ–ö
(–¥–æ–±–∞–≤—å —Ñ–æ—Ç–æ —Å—é–¥–∞)
![PLC connection](<img width="1280" height="960" alt="image" src="https://github.com/user-attachments/assets/48543e0c-7177-49f1-ad41-2bafa5fc3eb1" />) 
![PLC connection](<img width="1280" height="960" alt="image" src="https://github.com/user-attachments/assets/3a4eb0b6-db55-4604-aa94-ca2b5e810cb2" />) 

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1Ô∏è‚É£ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–æ–π

–ö–æ—Ä–æ—Ç–∫–æ–µ –Ω–∞–∂–∞—Ç–∏–µ  - –í—ã–±–æ—Ä –Ω–æ–º–µ—Ä–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ (1‚Äì8)
–î–ª–∏–Ω–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ  - (>2.2 —Å–µ–∫) –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞

–ò–Ω–¥–∏–∫–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤–∫–ª—é—á–µ–Ω–∏–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—ã—Ö–æ–¥–æ–≤.

2Ô∏è‚É£ –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–û–¥–∏–Ω —Ç–µ—Å—Ç –≤–∫–ª—é—á–∞–µ—Ç 60 —Ü–∏–∫–ª–æ–≤, –∫–∞–∂–¥—ã–π —Ü–∏–∫–ª: –ø–æ–æ—á–µ—Ä—ë–¥–Ω–æ –≤–∫–ª—é—á–∞–µ—Ç 8 –≤—ã—Ö–æ–¥–æ–≤;
–ø—Ä–æ–≤–µ—Ä—è–µ—Ç: —Ü–∏—Ñ—Ä–æ–≤—ã–µ –≤—Ö–æ–¥—ã (P1.0‚ÄìP1.7, P1.14‚ÄìP1.15); –∞–Ω–∞–ª–æ–≥–æ–≤—ã–µ –∫–∞–Ω–∞–ª—ã A0 –∏ A1; –ø–∏—Ç–∞–Ω–∏–µ; —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç: –æ—Ç–∫–∞–∑ –≤—ã—Ö–æ–¥–∞; —á–∞—Å—Ç–∏—á–Ω—ã–π –æ—Ç–∫–∞–∑ –≤—Ö–æ–¥–æ–≤; –∞–Ω–∞–ª–æ–≥–æ–≤—ã–µ –æ—à–∏–±–∫–∏.
–ò–∑ –≤—Å–µ—Ö —Ü–∏–∫–ª–æ–≤ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏—Ç–æ–≥–æ–≤—ã–π –ª–æ–≥.
<img width="960" height="1280" alt="image" src="https://github.com/user-attachments/assets/3894540e-d57b-4b9b-bce5-60dc1e099552" />

3Ô∏è‚É£ –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤

typedef struct {uint8_t TEST_NUMBER; // –Ω–æ–º–µ—Ä —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ 
                uint8_t error_state; // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ + –∏—Ç–æ–≥–æ–≤—ã–π 
                state uint16_t pin_mask; // –º–∞—Å–∫–∞ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –≤—Ö–æ–¥–æ–≤ (10 –±–∏—Ç) 
                uint8_t result_rele; // –º–∞—Å–∫–∞ —Ä–µ–ª–µ (8 –±–∏—Ç) 
                uint16_t result_A1; // –∞–Ω–∞–ª–æ–≥ A1 (12 –±–∏—Ç) 
                uint16_t result_A0; // –∞–Ω–∞–ª–æ–≥ A0 (12 –±–∏—Ç) 
                log_entry_t; 
                }
–í—Å–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤–æ Flash, –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–µ.

4Ô∏è‚É£ –†–∞–±–æ—Ç–∞ —Å Flash-–ø–∞–º—è—Ç—å—é

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è W25 SPI Flash. –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ. –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ—Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è Flash?–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–¥—Ä–µ—Å —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–ø–∏—Å–∏ (logs_find_write_addr). –û—á–∏—Å—Ç–∫–∞ —Å–µ–∫—Ç–æ—Ä–∞ ‚Äî –≤—Ä—É—á–Ω—É—é (logs_erase())

5Ô∏è‚É£ –í—ã–≤–æ–¥ –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ UART

–ö–æ–º–∞–Ω–¥–∞ —á–µ—Ä–µ–∑ UART:
log 
–†–µ–∑—É–ª—å—Ç–∞—Ç:
=== DUMP LOGS === 0001 0 1111111111 11111111 000000001100 000000111010 0002 3 1011111111 11111111 001001011100 001001111011 ... 
–§–æ—Ä–º–∞—Ç:
TEST ERR PIN_MASK RELAY A1 A0 

## –ò–Ω–¥–∏–∫–∞—Ü–∏—è

LED_RUN - –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–∞
LED_STATUS - –ò—Ç–æ–≥ —Ç–µ—Å—Ç–∞ / –æ—à–∏–±–∫–∞ –ø–∏—Ç–∞–Ω–∏—è
<img width="960" height="1280" alt="image" src="https://github.com/user-attachments/assets/bfcc7b74-4a52-4be1-b5f1-492dd539a0be" />

## –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–∏—Ç–∞–Ω–∏—è

–ü–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º —Ç–µ—Å—Ç–æ–≤ –∏–∑–º–µ—Ä—è–µ—Ç—Å—è –≤—Ö–æ–¥–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ:
–µ—Å–ª–∏ < 5 –í ‚Äî —Ç–µ—Å—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è;
–≤–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤–∞—Ä–∏–π–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è.
<img width="960" height="1280" alt="image" src="https://github.com/user-attachments/assets/ae68c365-32a4-4b9c-ab39-f727b3e757de" />

## –ò—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –ü–û

PlatformIO
framework-mik32v2-sdk
HAL-–¥—Ä–∞–π–≤–µ—Ä—ã: GPIO, ADC, SPIFI, UART
[env:mik32v2] 
platform = MIK32
board = mik32v2 
framework = framework-mik32v2-sdk 
build_flags = -Os -ffunction-sections 
              -fdata-sections 
              -Wl,--gc-sections 
              
## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

src/ ‚îú‚îÄ‚îÄ main.c ‚îú‚îÄ‚îÄ uart_lib.c ‚îú‚îÄ‚îÄ ... images/ ‚îú‚îÄ‚îÄ plc_connection.jpg ‚îú‚îÄ‚îÄ power_block.jpg ‚îú‚îÄ‚îÄ test_process.jpg README.md 

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

‚úÖ –†–∞–±–æ—á–∏–π
‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

## –í–æ–∑–º–æ–∂–Ω—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:

CRC –ª–æ–≥–æ–≤
—ç–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ –≤ CSV
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –æ—Ç–∫–∞–∑–æ–≤
–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ–∫—Ç–æ—Ä–æ–≤ Flash

## –ê–≤—Ç–æ—Ä

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –ü–õ–ö –∏ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏.

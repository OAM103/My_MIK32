# Slot Machine на MIK32 Amur

## Описание проекта
Проект представляет собой реализацию мини-казино автомата на базе микроконтроллера **MIK32 Amur**. Устройство оснащено:
- **SPI TFT LCD 3.5''**, на который выводятся три барабана с изображениями;
- **аналоговым джойстиком**, который управляет запуском вращения и задаёт вариативность скорости для случайности результата.

### Изображения на барабанах
Каждый барабан содержит **6 картинок**:
- Лимон
- Апельсин
- Вишня
- Колокол
- Клевер
- Семёрка

### Управление
- **Ось Y** джойстика — запуск вращения.
- **Ось X** — влияет на рандомизацию скорости и вероятность выпадения символов.

После завершения вращения:
- Средний горизонтальный ряд выделяется рамкой.
- Если во всех трёх барабанах выпало одинаковое изображение — отображается **победный экран**.

## Принцип работы
Вращение каждого барабана реализуется через структуру, содержащую текущую позицию, активность, скорость и количество оставшихся оборотов. Барабаны останавливаются поочерёдно, создавая эффект реальной игровой машины.

### Основной фрагмент кода вращения
```c
void Spin3Slots(uint16_t BG_COLOR)
{
    if(winFlag!=0) ClearMassDMA(320, 480, 0, 0, BG_COLOR);
    int active_count = 3; // для остановки по очереди
    while (active_count > 0)
    {
        for (int i = 0; i < 3; i++)
        {
            if (!reels[i].active) continue;

            // обновляем сдвиг
            reels[i].old_down = reels[i].down;
            reels[i].down += reels[i].speed;

            // переход к следующей картинке
            if (reels[i].down >= IMG_HEIGHT)
            {
                reels[i].down=0;
                reels[i].img = (reels[i].img + 1) % IMG_COUNT;
                reels[i].spins--;    // один оборот завершён
            }

            // замедление при конце движения
            if (reels[i].spins < 20 )
                reels[i].speed--;

            // остановка
            if (reels[i].speed <= 6 || reels[i].spins <= 0)
            {
                reels[i].speed = 0;
                reels[i].active = 0;
                reels[i].down = 0;
                active_count--;
            }
        }

        // обновление экрана — 3 барабана сразу
        Draw3Reels(BG_COLOR);
    }

    Clear3Reels(BG_COLOR);
    Draw3Reels(BG_COLOR);
    draw_rect(110,30,100,420,2,BG_COLOR);
    CheckWin();
}
```

## Фото устройства

![photo_2025-11-26_12-33-57](https://github.com/user-attachments/assets/851c7619-0253-4497-9092-7578360c5bae)
![photo_2025-11-26_12-33-54](https://github.com/user-attachments/assets/470615b1-fcb3-44e6-b9af-3512f948fa96)

## Особенности проекта
- Плавная анимация вращения всех барабанов
- Реалистичное поочерёдное замедление
- Рамка для выделения итоговой комбинации
- Проверка выигрыша
- Отдельный победный экран

## Используемые технологии
- **MIK32 Amur**
- **SPI TFT LCD 3.5''**
- **C / Embedded C**
- **Аналоговый джойстик**
- DMA и оптимизированная отрисовка

## Планы по развитию
- Добавить звуковые эффекты
- Реализовать меню или интерфейс настроек
- Добавить больше анимаций
- Создать систему ставок и счётчик очков



